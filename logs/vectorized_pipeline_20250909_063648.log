2025-09-09 06:36:48,814 - __main__ - INFO - === NEDIS Vectorized Synthetic Data Pipeline ===
2025-09-09 06:36:48,814 - __main__ - INFO - Initializing database connection
2025-09-09 06:36:48,875 - src.core.database - INFO - Connected to database: nedis_sample.duckdb
2025-09-09 06:36:48,882 - src.core.database - INFO - Database schemas created successfully
2025-09-09 06:36:48,884 - src.core.config - INFO - Configuration loaded from config/generation_params.yaml
2025-09-09 06:36:48,884 - __main__ - INFO - === Stage 1: Vectorized Patient Generation ===
2025-09-09 06:36:48,884 - src.vectorized.patient_generator - INFO - Starting vectorized patient generation: 1,000 records
2025-09-09 06:36:48,884 - src.vectorized.patient_generator - INFO - Loading reference data for vectorized generation
2025-09-09 06:36:48,889 - src.core.database - ERROR - Query execution failed: Binder Error: Referenced column "capacity_beds" not found in FROM clause!
Candidate bindings: "daily_capacity_std", "daily_capacity_mean", "ktas1_capacity", "ktas2_capacity", "attractiveness_score"

LINE 2:                 SELECT emorg_cd, adr, hospname, capacity_beds, lat, lng
                                                        ^
2025-09-09 06:36:48,890 - src.core.database - ERROR - Query: 
                SELECT emorg_cd, adr, hospname, capacity_beds, lat, lng
                FROM nedis_meta.hospital_capacity
            
2025-09-09 06:36:48,890 - __main__ - ERROR - Pipeline execution failed: Binder Error: Referenced column "capacity_beds" not found in FROM clause!
Candidate bindings: "daily_capacity_std", "daily_capacity_mean", "ktas1_capacity", "ktas2_capacity", "attractiveness_score"

LINE 2:                 SELECT emorg_cd, adr, hospname, capacity_beds, lat, lng
                                                        ^
2025-09-09 06:36:48,891 - __main__ - ERROR - Traceback (most recent call last):
  File "/Users/sjlee/Projects/nedis-synthetic-data/scripts/run_vectorized_pipeline.py", line 75, in run_vectorized_pipeline
    patients_df = patient_generator.generate_all_patients(generation_config)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sjlee/Projects/nedis-synthetic-data/src/vectorized/patient_generator.py", line 63, in generate_all_patients
    self._load_reference_data()
  File "/Users/sjlee/Projects/nedis-synthetic-data/src/vectorized/patient_generator.py", line 78, in _load_reference_data
    self._hospital_data = self.db.fetch_dataframe("""
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sjlee/Projects/nedis-synthetic-data/src/core/database.py", line 105, in fetch_dataframe
    result = self.execute_query(query, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sjlee/Projects/nedis-synthetic-data/src/core/database.py", line 87, in execute_query
    result = self.conn.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.BinderException: Binder Error: Referenced column "capacity_beds" not found in FROM clause!
Candidate bindings: "daily_capacity_std", "daily_capacity_mean", "ktas1_capacity", "ktas2_capacity", "attractiveness_score"

LINE 2:                 SELECT emorg_cd, adr, hospname, capacity_beds, lat, lng
                                                        ^

