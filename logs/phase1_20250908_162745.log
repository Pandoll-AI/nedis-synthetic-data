2025-09-08 16:27:45,486 - __main__ - INFO - Initializing database and configuration...
2025-09-08 16:27:45,488 - core.config - INFO - Configuration loaded from config/generation_params.yaml
2025-09-08 16:27:45,495 - core.database - INFO - Connected to database: nedis_sample.duckdb
2025-09-08 16:27:45,497 - core.database - INFO - Database schemas created successfully
2025-09-08 16:27:45,497 - __main__ - INFO - Database: nedis_sample.duckdb
2025-09-08 16:27:45,497 - __main__ - INFO - Config: ConfigManager(file=config/generation_params.yaml, target=9,200,000)
2025-09-08 16:27:45,500 - __main__ - INFO - Found 322,573 records in original data
2025-09-08 16:27:45,501 - __main__ - INFO - === Step 1: Population and Hospital Profiling ===
2025-09-08 16:27:45,504 - __main__ - INFO - Extracting population margins...
2025-09-08 16:27:45,504 - population.profiler - INFO - Starting population margins extraction
2025-09-08 16:27:45,504 - population.profiler - INFO - Found 322,573 records in original data
2025-09-08 16:27:45,512 - core.database - ERROR - Query execution failed: Conversion Error: invalid date field format: "20170101", expected format is (YYYY-MM-DD) when casting from source column vst_dt

LINE 9:             SUM(CASE WHEN MONTH(CAST(vst_dt AS DATE)) IN (3,4,5) THEN 1 ELSE 0 END)::DOUBLE...
                                        ^
2025-09-08 16:27:45,512 - core.database - ERROR - Query: 
        INSERT INTO nedis_meta.population_margins
        SELECT 
            pat_do_cd,
            pat_age_gr,
            pat_sex,
            COUNT(*) as yearly_visits,
            -- 계절별 가중치 계산
            SUM(CASE WHEN MONTH(CAST(vst_dt AS DATE)) IN (3,4,5) THEN 1 ELSE 0 END)::DOUBLE / COUNT(*) as seasonal_weight_spring,
            SUM(CASE WHEN MONTH(CAST(vst_dt AS DATE)) IN (6,7,8) THEN 1 ELSE 0 END)::DOUBLE / COUNT(*) as seasonal_weight_summer,
            SUM(CASE WHEN MONTH(CAST(vst
2025-09-08 16:27:45,512 - population.profiler - ERROR - Population margins extraction failed: Conversion Error: invalid date field format: "20170101", expected format is (YYYY-MM-DD) when casting from source column vst_dt

LINE 9:             SUM(CASE WHEN MONTH(CAST(vst_dt AS DATE)) IN (3,4,5) THEN 1 ELSE 0 END)::DOUBLE...
                                        ^
2025-09-08 16:27:45,512 - __main__ - ERROR - Population profiling failed: Population margins extraction failed
2025-09-08 16:27:45,513 - __main__ - ERROR - Phase 1 failed at profiling step
2025-09-08 16:27:45,531 - core.database - INFO - Database connection closed
