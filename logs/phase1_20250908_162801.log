2025-09-08 16:28:01,960 - __main__ - INFO - Initializing database and configuration...
2025-09-08 16:28:01,962 - core.config - INFO - Configuration loaded from config/generation_params.yaml
2025-09-08 16:28:01,969 - core.database - INFO - Connected to database: nedis_sample.duckdb
2025-09-08 16:28:01,971 - core.database - INFO - Database schemas created successfully
2025-09-08 16:28:01,971 - __main__ - INFO - Database: nedis_sample.duckdb
2025-09-08 16:28:01,971 - __main__ - INFO - Config: ConfigManager(file=config/generation_params.yaml, target=9,200,000)
2025-09-08 16:28:01,972 - __main__ - INFO - Found 322,573 records in original data
2025-09-08 16:28:01,972 - __main__ - INFO - === Step 1: Population and Hospital Profiling ===
2025-09-08 16:28:01,973 - __main__ - INFO - Extracting population margins...
2025-09-08 16:28:01,973 - population.profiler - INFO - Starting population margins extraction
2025-09-08 16:28:01,973 - population.profiler - INFO - Found 322,573 records in original data
2025-09-08 16:28:01,992 - population.profiler - INFO - Created 276 population margin combinations
2025-09-08 16:28:01,992 - __main__ - INFO - ✓ Created 276 population margin combinations in 0.02s
2025-09-08 16:28:01,992 - __main__ - INFO - Extracting hospital statistics...
2025-09-08 16:28:01,992 - population.profiler - INFO - Starting hospital statistics extraction
2025-09-08 16:28:02,006 - population.profiler - INFO - Updated statistics for 12 hospitals
2025-09-08 16:28:02,006 - population.profiler - INFO - Capacity range: 36 - 154 (avg: 73)
2025-09-08 16:28:02,006 - __main__ - INFO - ✓ Updated statistics for 12 hospitals in 0.01s
2025-09-08 16:28:02,006 - __main__ - INFO - Generating basic profile report...
2025-09-08 16:28:02,020 - population.profiler - INFO - Basic data profile report generated
2025-09-08 16:28:02,021 - core.database - ERROR - Query execution failed: Not implemented Error: Unable to transform python value of type '<class 'numpy.int64'>' to DuckDB LogicalType
2025-09-08 16:28:02,021 - core.database - ERROR - Query: 
            UPDATE nedis_meta.pipeline_progress 
            SET status = ?, end_time = CURRENT_TIMESTAMP, 
                records_processed = ?, error_message = ?
            WHERE step_name = ?
            
2025-09-08 16:28:02,021 - __main__ - WARNING - Failed to update pipeline progress: Not implemented Error: Unable to transform python value of type '<class 'numpy.int64'>' to DuckDB LogicalType
2025-09-08 16:28:02,021 - __main__ - INFO - === Step 2: Conditional Probability Extraction ===
2025-09-08 16:28:02,021 - __main__ - INFO - Creating KTAS conditional probability table...
2025-09-08 16:28:02,021 - clinical.conditional_probability - INFO - Starting KTAS conditional probability table creation
2025-09-08 16:28:02,035 - core.database - ERROR - Query execution failed: Constraint Error: NOT NULL constraint failed: ktas_conditional_prob.pat_age_gr
2025-09-08 16:28:02,035 - core.database - ERROR - Query: 
            WITH ktas_counts AS (
                SELECT 
                    pat_age_gr,
                    pat_sex,
                    gubun,
                    vst_meth,
                    ktas_fstu,
                    COUNT(*) as count
                FROM nedis_original.nedis2017
                WHERE pat_age_gr != '' AND pat_age_gr IS NOT NULL
                  AND pat_sex IN ('M', 'F')
                  AND gubun != '' AND gubun IS NOT NULL
                  AND vst_meth != '' AND v
2025-09-08 16:28:02,035 - clinical.conditional_probability - ERROR - KTAS probability table creation failed: Constraint Error: NOT NULL constraint failed: ktas_conditional_prob.pat_age_gr
2025-09-08 16:28:02,035 - __main__ - ERROR - Conditional probability extraction failed: KTAS probability table creation failed
2025-09-08 16:28:02,036 - __main__ - ERROR - Phase 1 failed at probability extraction step
2025-09-08 16:28:02,058 - core.database - INFO - Database connection closed
