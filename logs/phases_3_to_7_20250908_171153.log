2025-09-08 17:11:53,221 - __main__ - INFO - === NEDIS Synthetic Data Pipeline - Phases 3-7 ===
2025-09-08 17:11:53,222 - __main__ - INFO - Phases to run: 4
2025-09-08 17:11:53,222 - __main__ - INFO - Sample days: 1
2025-09-08 17:11:53,222 - __main__ - INFO - Validation sample size: 50000
2025-09-08 17:11:53,281 - src.core.database - INFO - Connected to database: nedis_sample.duckdb
2025-09-08 17:11:53,284 - src.core.database - INFO - Database schemas created successfully
2025-09-08 17:11:53,286 - src.core.config - INFO - Configuration loaded from config/generation_params.yaml
2025-09-08 17:11:53,286 - __main__ - INFO - === Starting Phase 4: Clinical Attributes Generation ===
2025-09-08 17:11:53,286 - __main__ - INFO - Step 1: Initializing clinical records table
2025-09-08 17:11:53,286 - src.clinical.dag_generator - INFO - Initializing clinical records table
2025-09-08 17:11:53,286 - src.clinical.dag_generator - INFO - Clinical records table created successfully
2025-09-08 17:11:53,286 - __main__ - INFO - Step 2: Initializing diagnosis tables
2025-09-08 17:11:53,286 - src.clinical.diagnosis_generator - INFO - Initializing diagnosis tables
2025-09-08 17:11:53,287 - src.core.database - ERROR - Query execution failed: Parser Error: Expected a constant as type modifier
2025-09-08 17:11:53,287 - src.core.database - ERROR - Query: 
                CREATE TABLE nedis_synthetic.diag_er (
                    index_key VARCHAR NOT NULL,
                    position INTEGER NOT NULL,
                    diagnosis_code VARCHAR NOT NULL,
                    diagnosis_category VARCHAR DEFAULT '1',
                    icd_chapter VARCHAR,
                    generation_method VARCHAR DEFAULT 'conditional_probability',
                    PRIMARY KEY (index_key, position),
                    
                    -- 외래 키 제약
       
2025-09-08 17:11:53,287 - src.clinical.diagnosis_generator - ERROR - Failed to initialize diagnosis tables: Parser Error: Expected a constant as type modifier
2025-09-08 17:11:53,287 - __main__ - ERROR - Phase 4 failed: Parser Error: Expected a constant as type modifier
2025-09-08 17:11:53,287 - __main__ - INFO - === Pipeline Execution Summary ===
2025-09-08 17:11:53,287 - __main__ - INFO - Phases completed: 0/1
2025-09-08 17:11:53,288 - __main__ - INFO - Success rate: 0.0%
2025-09-08 17:11:53,288 - __main__ - WARNING - ⚠️ 1 phases failed
