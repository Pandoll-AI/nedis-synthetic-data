2025-09-09 06:53:49,148 - __main__ - INFO - === NEDIS Vectorized Synthetic Data Pipeline ===
2025-09-09 06:53:49,148 - __main__ - INFO - Initializing database connection
2025-09-09 06:53:49,188 - src.core.database - INFO - Connected to database: nedis_sample.duckdb
2025-09-09 06:53:49,193 - src.core.database - INFO - Database schemas created successfully
2025-09-09 06:53:49,195 - src.core.config - INFO - Configuration loaded from config/generation_params.yaml
2025-09-09 06:53:49,195 - __main__ - INFO - === Stage 1: Vectorized Patient Generation ===
2025-09-09 06:53:49,195 - src.vectorized.patient_generator - INFO - Starting vectorized patient generation: 322,573 records
2025-09-09 06:53:49,195 - src.vectorized.patient_generator - INFO - Loading reference data for vectorized generation
2025-09-09 06:53:49,203 - src.vectorized.patient_generator - INFO - Caching probability distributions
2025-09-09 06:53:49,237 - src.vectorized.patient_generator - INFO - Vectorized generation of 322,573 patients
2025-09-09 06:53:49,289 - src.vectorized.patient_generator - INFO - Vectorized hospital assignment using gravity model
2025-09-09 06:53:49,451 - src.vectorized.patient_generator - INFO - Generating independent clinical attributes
2025-09-09 06:53:49,601 - src.vectorized.patient_generator - INFO - Generating conditional clinical attributes
2025-09-09 06:53:50,085 - src.vectorized.patient_generator - INFO - Generated 322,573 patients successfully
2025-09-09 06:53:50,089 - __main__ - INFO - Stage 1 completed in 0.89 seconds
2025-09-09 06:53:50,090 - __main__ - INFO - Generated 322,573 patients
2025-09-09 06:53:50,090 - __main__ - INFO - === Stage 2: Temporal Pattern Assignment ===
2025-09-09 06:53:50,090 - src.vectorized.temporal_assigner - INFO - Assigning temporal patterns to 322,573 patients
2025-09-09 06:53:50,090 - src.vectorized.temporal_assigner - INFO - Loading temporal patterns for year 2017
2025-09-09 06:53:50,098 - src.core.database - ERROR - Query execution failed: Conversion Error: invalid date field format: "20170105", expected format is (YYYY-MM-DD) when casting from source column vst_dt

LINE 4:                     EXTRACT(DOW FROM CAST(vst_dt AS DATE)) as day_of_week,
                                             ^
2025-09-09 06:53:50,098 - src.core.database - ERROR - Query: 
                SELECT 
                    vst_dt,
                    EXTRACT(DOW FROM CAST(vst_dt AS DATE)) as day_of_week,
                    EXTRACT(MONTH FROM CAST(vst_dt AS DATE)) as month,
                    COUNT(*) as daily_count
                FROM nedis_original.nedis2017
                GROUP BY vst_dt
                ORDER BY vst_dt
            
2025-09-09 06:53:50,099 - __main__ - ERROR - Pipeline execution failed: Conversion Error: invalid date field format: "20170105", expected format is (YYYY-MM-DD) when casting from source column vst_dt

LINE 4:                     EXTRACT(DOW FROM CAST(vst_dt AS DATE)) as day_of_week,
                                             ^
2025-09-09 06:53:50,099 - __main__ - ERROR - Traceback (most recent call last):
  File "/Users/sjlee/Projects/nedis-synthetic-data/scripts/run_vectorized_pipeline.py", line 93, in run_vectorized_pipeline
    patients_with_dates_df = temporal_assigner.assign_temporal_patterns(
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sjlee/Projects/nedis-synthetic-data/src/vectorized/temporal_assigner.py", line 64, in assign_temporal_patterns
    self._load_temporal_patterns(temporal_config.year)
  File "/Users/sjlee/Projects/nedis-synthetic-data/src/vectorized/temporal_assigner.py", line 88, in _load_temporal_patterns
    original_daily_pattern = self.db.fetch_dataframe(f"""
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sjlee/Projects/nedis-synthetic-data/src/core/database.py", line 105, in fetch_dataframe
    result = self.execute_query(query, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sjlee/Projects/nedis-synthetic-data/src/core/database.py", line 87, in execute_query
    result = self.conn.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.ConversionException: Conversion Error: invalid date field format: "20170105", expected format is (YYYY-MM-DD) when casting from source column vst_dt

LINE 4:                     EXTRACT(DOW FROM CAST(vst_dt AS DATE)) as day_of_week,
                                             ^

