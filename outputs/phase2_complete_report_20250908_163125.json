{
  "phase": 2,
  "generation_timestamp": "2025-09-08T16:31:25.887105",
  "config_summary": {
    "config_file": "config/generation_params.yaml",
    "target_records": 9200000,
    "database_path": "nedis_sample.duckdb",
    "log_level": "INFO",
    "phases_configured": [
      "database",
      "population",
      "temporal",
      "allocation",
      "clinical",
      "temporal_patterns",
      "validation",
      "logging",
      "optimization"
    ],
    "last_loaded": "2025-09-08T16:31:25.887114"
  },
  "population_volumes": {
    "generation_timestamp": "2025-09-08T16:31:25.887192",
    "parameters": {
      "dirichlet_alpha": 1.0,
      "batch_size": 10000
    },
    "statistics": {
      "total_combinations": 276.0,
      "total_records": 9200000.0,
      "avg_records": 33333.333333333336,
      "min_records": 197.0,
      "max_records": 659104.0,
      "unique_regions": 17.0,
      "unique_age_groups": 11.0,
      "unique_genders": 2.0
    },
    "top_regions": [
      {
        "pat_do_cd": "11",
        "combinations": 22,
        "total_records": 7899992.0,
        "avg_records": 359090.54545454547
      },
      {
        "pat_do_cd": "41",
        "combinations": 22,
        "total_records": 897280.0,
        "avg_records": 40785.454545454544
      },
      {
        "pat_do_cd": "28",
        "combinations": 20,
        "total_records": 84786.0,
        "avg_records": 4239.3
      },
      {
        "pat_do_cd": "44",
        "combinations": 18,
        "total_records": 47981.0,
        "avg_records": 2665.6111111111113
      },
      {
        "pat_do_cd": "42",
        "combinations": 18,
        "total_records": 42393.0,
        "avg_records": 2355.1666666666665
      },
      {
        "pat_do_cd": "46",
        "combinations": 18,
        "total_records": 32653.0,
        "avg_records": 1814.0555555555557
      },
      {
        "pat_do_cd": "47",
        "combinations": 18,
        "total_records": 32185.0,
        "avg_records": 1788.0555555555557
      },
      {
        "pat_do_cd": "45",
        "combinations": 17,
        "total_records": 30873.0,
        "avg_records": 1816.0588235294117
      },
      {
        "pat_do_cd": "43",
        "combinations": 18,
        "total_records": 29531.0,
        "avg_records": 1640.611111111111
      },
      {
        "pat_do_cd": "48",
        "combinations": 17,
        "total_records": 24973.0,
        "avg_records": 1469.0
      }
    ],
    "gender_distribution": [
      {
        "pat_sex": "F",
        "combinations": 137,
        "total_records": 4412226.0
      },
      {
        "pat_sex": "M",
        "combinations": 139,
        "total_records": 4787774.0
      }
    ]
  },
  "population_validation": {
    "timestamp": "2025-09-08T16:31:25.889018",
    "checks": {
      "zero_records": "0",
      "original_total": 294708.0,
      "synthetic_total": 9200000.0,
      "synthetic_to_original_ratio": 31.217340554039932,
      "region_consistency": {
        "regions_matched": 17.0,
        "avg_relative_error": 30.215424922956966
      },
      "extreme_values": {
        "extreme_high": 13,
        "extreme_low": 0
      }
    },
    "issues": [
      "Unusual ratio: synthetic/original = 31.22",
      "13 extremely high values detected"
    ],
    "passed": false
  },
  "temporal_patterns": {
    "generation_timestamp": "2025-09-08T16:31:25.890795",
    "parameters": {
      "holidays_count": 16,
      "chunk_size": 1000,
      "batch_size": 10000
    },
    "basic_statistics": {
      "total_daily_records": 36308.0,
      "unique_dates": 365.0,
      "total_visits": 9200089.0,
      "avg_daily_visits": 253.39013440564062,
      "min_daily_visits": 8.0,
      "max_daily_visits": 5488.0,
      "avg_lambda": 21.801805444336296,
      "unique_combinations": 276.0
    },
    "error": "Conversion Error: invalid date field format: \"20170120\", expected format is (YYYY-MM-DD) when casting from source column vst_dt\n\nLINE 6:                 CASE DAYOFWEEK(CAST(vst_dt AS DATE))\n                                       ^"
  },
  "temporal_validation": {
    "timestamp": "2025-09-08T16:31:25.895046",
    "checks": {
      "date_range": {
        "min_date": "20170101",
        "max_date": "20171231",
        "unique_dates": 365
      },
      "negative_values": {
        "negative_counts": 0,
        "negative_lambdas": 0
      },
      "total_consistency": {
        "yearly_total": 9200000.0,
        "daily_total": 9200089.0
      },
      "total_error_rate": 9.673913043478262e-06
    },
    "issues": [],
    "error": "Binder Error: column \"avg_daily\" must appear in the GROUP BY clause or must be part of an aggregate function.\nEither add it to the GROUP BY list, or use \"ANY_VALUE(avg_daily)\" if the exact value of \"avg_daily\" is not important.\n\nLINE 17:                 s.avg_daily, s.std_daily\n                         ^",
    "passed": false
  },
  "pipeline_progress": [
    {
      "step_name": "phase2_daily_volumes",
      "status": "completed",
      "records_processed": 36308,
      "start_time": "2025-09-08 16:31:25.395000",
      "end_time": "2025-09-08 16:31:25.874000"
    },
    {
      "step_name": "phase2_yearly_volumes",
      "status": "completed",
      "records_processed": 276,
      "start_time": "2025-09-08 16:31:25.341000",
      "end_time": "2025-09-08 16:31:25.386000"
    }
  ],
  "consistency_checks": {
    "totals": {
      "yearly_total": 9200000.0,
      "daily_total": 9200089.0,
      "difference": 89.0,
      "difference_pct": 0.0009673913043478262
    },
    "combinations": {
      "yearly_combinations": "276",
      "daily_unique_combinations": "276",
      "coverage_rate": 1.0
    },
    "date_coverage": {
      "min_date": "20170101",
      "max_date": "20171231",
      "unique_dates": 365
    },
    "data_quality": {
      "zero_count_records": 0.0,
      "negative_count_records": 0.0,
      "negative_lambda_records": 0.0,
      "avg_daily_count": 253.39013440564062,
      "std_daily_count": 671.7785039793544
    }
  }
}